#' Title
#'
#' @param genomePath
#' @param genepath
#' @param lengthconf
#' @param identconf
#'
#' @return
#' @export
#'
#' @examples
find.closest <- function(genomePath,genepath,lengthconf = 100, identconf =100 )
{
  dir.create('temp')
  dir.create('temp/dbblast')
  myarg <-paste0('-in ',genomePath,' -out temp/dbblast/db -dbtype nucl')
  system2(command = 'makeblastdb', args = myarg,stdout=F)

  myarg <-  paste0('-query ',genepath,' -db temp/dbblast/db -out temp/blast.txt -num_threads 8 -num_alignments 10 -outfmt "7 qacc bitscore qlen length pident qstart qend sacc sstart send "' )
  system2(command = 'blastn', args = myarg)

  blast <- try(read.table('temp/blast.txt', comment.char = '#'),silent=T)
  if(class(blast)=='data.frame')
  {
    colnames(blast) <- c('querry.access','bit.score','querry.length','alignment.lenght','pc.ident.','querry.start','querry.end','subject.access','subject.start','subject.end')
    blast <- blast[(blast$alignment.lenght>=blast$querry.length*lengthconf/100),]
    blast <- blast[(blast$pc.ident.>=identconf),]
    result <- paste0('',as.character(blast$querry.access)[which.max(blast$bit.score)])
  }
  else{result <- ''}
  return(result)

}
